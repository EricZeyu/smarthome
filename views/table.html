<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"> 
	<title><%= title %></title>
	<link rel="stylesheet" href="stylesheets/style.css">
	<link rel="stylesheet" href="libs/bootstrap-3.3.6/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="libs/bootstrap-table-master/dist/bootstrap-table.min.css">
</head>
<body>

<div class="jumbotron" style="background: Beige">
  	<h1>Welcome, <%= name %>.</h1>
  	<div class="input-group" style="float: right;">
  		<form class="navbar-form navbar-left" role="search" action="/logout" method="POST">
		  	<button type="submit" class="btn btn-default">Sign Out</button>
		</form>
	</div>
</div>

<ul class="nav nav-pills">
  	<li role="presentation" class="active"><a href="#">Gateways</a></li>
  	<li role="presentation"><a href="#">Users</a></li>
  	<li role="presentation"><a href="#">Messages</a></li>
</ul>

        <table id="table"
               data-height="400"
               data-url="mytabledata.json"
               data-sort-name="IP"
               data-sort-order="desc"
               >
            <thead>
            <tr>
                <th data-field="IP" data-sortable="true">IP</th>
                <th data-field="port" data-sortable="true">port</th>
                <th data-field="Owner" data-sortable="true">Owner</th>
            </tr>
            </thead>
        </table>

<div class="panel panel-default">

  	<table class="table">
  		<tr id="tr_0">
  			<th>#</th>
  			<th>IP</th>
  			<th>Port</th>
  			<th>Owner</th>
  		</tr>
  		<tr>
  			<th>1</th><th></th><th></th><th></th>
  		</tr>
  		<tr>
  			<th>2</th><th></th><th></th><th></th>
  		</tr>
  		<tr>
  			<th>3</th><th></th><th></th><th></th>
  		</tr>
  		<tr>
  			<th>4</th><th></th><th></th><th></th>
  		</tr>
  		<tr>
  			<th>5</th><th></th><th></th><th></th>
  		</tr>
  		<tr>
  			<th>6</th><th></th><th></th><th></th>
  		</tr>
  		<tr>
  			<th>7</th><th></th><th></th><th></th>
  		</tr>
  		<tr>
  			<th>8</th><th></th><th></th><th></th>
  		</tr>
  		<tr>
  			<th>9</th><th></th><th></th><th></th>
  		</tr>

  	</table>
</div>


	<script src="libs/jquery-2.2.4/dist/jquery.min.js"></script>
	<script src="libs/bootstrap-3.3.6/dist/js/bootstrap.min.js"></script>
	<script src="libs/bootstrap-table-master/dist/bootstrap-table.min.js"></script>
	<script src="/socket.io/socket.io.js"></script>
	<script>
		
		$(document).ready(function(){

			var socket = io.connect();
			socket.emit('Start_Info', {info : 'Gateways'});

			socket.on('Gateways', (Gateways) => {
				
				console.log(Gateways);

				$("#table").bootstrapTable('load', Gateways);

				var data_parse = JSON.parse(Gateways);

						var trdraw = $("#tr_0");
						for (var i=0; i<data_parse.length; i++) {
							trdraw = trdraw.next();
							thdraw = trdraw.children().next();
							thdraw.text(data_parse[i].IP);
							thdraw = thdraw.next();
							thdraw.text(data_parse[i].port);
							thdraw = thdraw.next();
							thdraw.text(data_parse[i].Owner);
						}

						for (var j=i; j<9; j++) {
							trdraw = trdraw.next();
							thdraw = trdraw.children().nextAll().text("");
						}
			});

		});

		$(document).unload(function(){
			socket.emit('End_Info', {info : 'Gateways'});
		});

	</script>
	<!-- 	<script>

		function f(){
			console.log("hello");

			// $.get("/get_sockets_info", (data) => {

			// 		var draw = $("#row1 .col-md-4").first();

			// 	//	console.log("data = ", data);
			// 		var data_parse = JSON.parse(data);
			// 	//	console.log("data_parse = ", data_parse);

			// 		for (var i=0; i<data_parse.length; i++)
			// 		{
			// 			draw.text(JSON.stringify(data_parse[i]));
			// 			draw = draw.next();
			// 		}

			// 		draw.text("null");
			// 		draw.nextAll().text("null");

			// 		var trdraw = $("#tr_0");
			// 		for (var i=0; i<data_parse.length; i++) {
			// 			trdraw = trdraw.next();
			// 			thdraw = trdraw.children().next();
			// 			thdraw.text(data_parse[i].IP);
			// 			thdraw = thdraw.next();
			// 			thdraw.text(data_parse[i].port);
			// 			thdraw = thdraw.next();
			// 			thdraw.text("testing");
			// 		}

			// 		for (var j=i; j<9; j++) {
			// 			trdraw = trdraw.next();
			// 			thdraw = trdraw.children().nextAll().text("");
			// 		}

			// 	});
		}

		$(document).ready(function(){

				var mything = window.setInterval('f()', 2000);

			// 	console.log("hello");

			// 	$.get("/get_sockets_info", (data) => {
			// 		// $("#col1").text(data);
			// 		var draw = $("#row1 .col-md-4").first();
			// 		// console.log(data);
			// 		// console.log(data[0]);
			// 		// console.log(data[2]);
			// 		// console.log(eval(data).length);
			// //		var data_parse = eval("(" + data + ")");
			// 		// var data3 = JSON.stringify(data);
			// 		// console.log("Data3=" + data3);
			// 		// var data4 = JSON.parse(data);
			// 		// console.log("Data4=" + data4);

			// 		var data_parse = JSON.parse(data);
			// 		// console.log(data_parse);
			// 		// console.log(data_parse.length);
			// 		// console.log(data_parse[0].IP);

			// 		for (var i=0; i<data_parse.length; i++)
			// 		{
			// 			// var json[i] = eval("(" + data + ")");
			// 			draw.text(JSON.stringify(data_parse[i]));
			// 			// draw.text(data_parse[i]);
			// 			draw = draw.next();
			// 		}
			// 	});
		});

		$(document).unload(function(){
			window.clearInterval(mything);
		});
	</script> -->
</body>
</html>